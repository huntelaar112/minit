# syntax=docker/dockerfile:1
ARG USER=root BUILDDIR="/build" MINIBASESETUP="/build/minitBaseSetup"
ARG DOCKER_BUILDKIT=1

FROM  mysql:5.5
LABEL maintainer="khacman98@gmail.com"

ARG USER BUILDDIR MINIBASESETUP EXPOSE_PORT="3306" DOCKER_BUILDKIT
ENV TZ=Asia/Ho_Chi_Minh
ENV DEBIAN_FRONTEND="teletype" \
    LANG="en_US.UTF-8" \
    LANGUAGE="en_US:en" \
    LC_ALL="en_US.UTF-8"

RUN echo "deb http://archive.debian.org/debian-security stretch/updates main" >>/etc/apt/sources.list

#RUN apt-get update -y || true
#RUN apt-get install -y curl wget sudo 

COPY <<EOF /etc/mysql/conf.d/cloudstack.cnf
[mysqld]
innodb_rollback_on_timeout=1
innodb_lock_wait_timeout=600
max_connections=700
log-bin=mysql-bin
binlog-format = 'ROW'
bind-address = 0.0.0.0
EOF

#RUN service mysql restart && ufw allow mysql

EXPOSE ${EXPOSE_PORT}
#ENTRYPOINT ["cloudstack-setup-management"]
